# README

## Get started

You need docker installed on your system. Run `docker compose up` to boot the application.
Docker compose is used to mount current dir to `/app` in the container, so that state is
preserved between reboots.

    git clone git@github.com:muxcmux/florio-challenge.git challenge

### Migrate the database

    docker exec -it challenge-app-1 bundle exec rails db:migrate

`challenge-app-1` is the name automatically given by docker compose. If you have cloned in
a different dir, then change this accordingly

## Usage

This is Rails API-only app. It runs on port 3000. Open your favourite networking client to
interact with it. Interactive API documentation is available on http://localhost:3000/api-docs

The available endpoints are:

* `POST /api/v1/patients.json` - creates a new patient
* `POST /api/v1/injections.json` - create a new injection record
* `GET /api/v1/injections.json` - view injection records
* `GET /api/v1/patients/adherence_score.json` - get the adherence score for a patient

(more info and usage on http://localhost:3000/api-docs - autogenerated from request specs)

### Metrics
Yabeda is configured to collect basic rails metrics: # of reqs, req duration, db query and
view rendering time, etc. By default it runs a prometheus exporter on port 9394, but this
is disabled by default. To enable it, open `compose.yml` and uncomment 9394 port forwarding


## Implemented features

* ✅ Build an endpoint that allows the creation of a patient. A patient has an id and a secure api_key which should be randomly generated.
* ✅ Build an endpoint that allows the creation of an injection. An injection consists of its dose (in millimeters), lot number (an alphanumeric text of 6 characters), drug name, and is associated with a specific patient.
* ✅ Build an endpoint that allows the retrieval of injections associated with a patient.
* ✅ Build an endpoint that allows the retrieval of the patient’s adherence score.
* ✅ The injection and adherence score endpoints should be publicly available but protected by an api_key.
* ✅ The code should be tested.

### Bonus features

* ✅ Documentation for the API (OpenAPI, API Blueprint, RAML, etc).
* ✅ Exposing metrics (hardware, health, requests, etc) available for a Prometheus agent to capture - this endpoint should not be publicly accessible.
* ✅ If using Github or GitLab, use any free tier of CI/CD products (Travis, circle, actions, etc) to run the tests and linters when pushing upstream.
* ❌ A frontend.
